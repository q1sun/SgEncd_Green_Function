function [V_mesh, V_Qpts, W_Qpts] = generate_mesh_quadrature_points(V_mesh, T_mesh,number_of_quadrature_points)

format short e


% quadrature points in each element
number_of_elements=size(T_mesh,2);
V_Qpts = zeros(number_of_elements * number_of_quadrature_points, 2); % coordinates
W_Qpts = zeros(number_of_elements * number_of_quadrature_points, 1); % weights

for n = 1 : number_of_elements

    % generate quadrature weights and points on local element       
    vertices_triangle = [V_mesh(:,T_mesh(1,n))';V_mesh(:,T_mesh(2,n))';V_mesh(:,T_mesh(3,n))'];
    [quadrature_weight_local_2D, quadrature_point_local_2D] = generate_Gauss_point_local_triangle(number_of_quadrature_points,vertices_triangle);

    V_Qpts(number_of_quadrature_points * (n-1) + 1 : number_of_quadrature_points * n, :) = quadrature_point_local_2D;
    W_Qpts(number_of_quadrature_points * (n-1) + 1 : number_of_quadrature_points * n, 1) = quadrature_weight_local_2D';
    
end
end

function [Gauss_coefficient_local_triangle,Gauss_point_local_triangle]=generate_Gauss_point_local_triangle(Gauss_point_number,vertices_triangle)

    if Gauss_point_number==3
        Gauss_coefficient_local_triangle=[1/6,1/6,1/6]*det([ones(1,3);vertices_triangle']); 
        Gauss_point_local_triangle=[1-1/2-0,1/2,0;...
                                    1-1/2-1/2,1/2,1/2;...
                                    1-0-1/2,0,1/2]...
                                    *vertices_triangle;
    elseif Gauss_point_number==4
        Gauss_coefficient_local_triangle=[(1-1/sqrt(3))/8,(1-1/sqrt(3))/8,(1+1/sqrt(3))/8,(1+1/sqrt(3))/8]*det([ones(1,3);vertices_triangle']);
        Gauss_point_local_triangle=[1-(1/sqrt(3)+1)/2-(1-1/sqrt(3))*(1+1/sqrt(3))/4,(1/sqrt(3)+1)/2,(1-1/sqrt(3))*(1+1/sqrt(3))/4;...
                                    1-(1/sqrt(3)+1)/2-(1-1/sqrt(3))*(1-1/sqrt(3))/4,(1/sqrt(3)+1)/2,(1-1/sqrt(3))*(1-1/sqrt(3))/4;...
                                    1-(-1/sqrt(3)+1)/2-(1+1/sqrt(3))*(1+1/sqrt(3))/4,(-1/sqrt(3)+1)/2,(1+1/sqrt(3))*(1+1/sqrt(3))/4;...
                                    1-(-1/sqrt(3)+1)/2-(1+1/sqrt(3))*(1-1/sqrt(3))/4,(-1/sqrt(3)+1)/2,(1+1/sqrt(3))*(1-1/sqrt(3))/4]...
                                    *vertices_triangle;
    elseif Gauss_point_number==7
        Gauss_coefficient_local_triangle=[0.22500000000000000,0.12593918054482717,0.12593918054482717,0.12593918054482717,0.13239415278850616,0.13239415278850616,0.13239415278850616]/2*det([ones(1,3);vertices_triangle']);
        Gauss_point_local_triangle=[1-1/3-1/3,1/3,1/3;...
                                    1-0.79742698535308720-0.10128650732345633,0.79742698535308720,0.10128650732345633;...
                                    1-0.10128650732345633-0.79742698535308720,0.10128650732345633,0.79742698535308720;...
                                    1-0.10128650732345633-0.10128650732345633,0.10128650732345633,0.10128650732345633;...
                                    1-0.05971587178976981-0.47014206410511505,0.05971587178976981,0.47014206410511505;...
                                    1-0.47014206410511505-0.05971587178976981,0.47014206410511505,0.05971587178976981;...
                                    1-0.47014206410511505-0.47014206410511505,0.47014206410511505,0.47014206410511505]...
                                    *vertices_triangle;
    elseif Gauss_point_number==9
        Gauss_coefficient_local_triangle=[64/81*(1-0)/8,100/324*(1-sqrt(3/5))/8,100/324*(1-sqrt(3/5))/8,100/324*(1+sqrt(3/5))/8,100/324*(1+sqrt(3/5))/8,40/81*(1-0)/8,40/81*(1-0)/8,40/81*(1-sqrt(3/5))/8,40/81*(1+sqrt(3/5))/8]*det([ones(1,3);vertices_triangle']);
        Gauss_point_local_triangle=[1-(1+0)/2-(1-0)*(1+0)/4,(1+0)/2,(1-0)*(1+0)/4;...
                                    1-(1+sqrt(3/5))/2-(1-sqrt(3/5))*(1+sqrt(3/5))/4,(1+sqrt(3/5))/2,(1-sqrt(3/5))*(1+sqrt(3/5))/4;...
                                    1-(1+sqrt(3/5))/2-(1-sqrt(3/5))*(1-sqrt(3/5))/4,(1+sqrt(3/5))/2,(1-sqrt(3/5))*(1-sqrt(3/5))/4;...
                                    1-(1-sqrt(3/5))/2-(1+sqrt(3/5))*(1+sqrt(3/5))/4,(1-sqrt(3/5))/2,(1+sqrt(3/5))*(1+sqrt(3/5))/4;...
                                    1-(1-sqrt(3/5))/2-(1+sqrt(3/5))*(1-sqrt(3/5))/4,(1-sqrt(3/5))/2,(1+sqrt(3/5))*(1-sqrt(3/5))/4;...
                                    1-(1+0)/2-(1-0)*(1+sqrt(3/5))/4,(1+0)/2,(1-0)*(1+sqrt(3/5))/4;...
                                    1-(1+0)/2-(1-0)*(1-sqrt(3/5))/4,(1+0)/2,(1-0)*(1-sqrt(3/5))/4;...
                                    1-(1+sqrt(3/5))/2-(1-sqrt(3/5))*(1+0)/4,(1+sqrt(3/5))/2,(1-sqrt(3/5))*(1+0)/4;...
                                    1-(1-sqrt(3/5))/2-(1+sqrt(3/5))*(1+0)/4,(1-sqrt(3/5))/2,(1+sqrt(3/5))*(1+0)/4]...
                                    *vertices_triangle;
    end
    
end









