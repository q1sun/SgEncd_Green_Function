function [quadrature_weight_local_triangle,quadrature_point_local_triangle] = Quadrature_Rule_Local_Triangle(vertices_triangle, number_of_quadrature_points)

format short e

% reference triangle: (0,0) (1,0) (0,1)
% vertices_triangle(i,:) denotes x- and y-coordinate of local triangle's ith vertex, where i ranges from 1 to 3
% quadrature_point_local_triangle(j,:) denotes x- and y- coordinate of jth local quadrature point, where j ranges from 1 to number_of_quadrature_points
% quadrature_weight_local_triangle(j) denotes the weight of jth local quadrature point
% 
% quadrature_weight_local_triangle = quadrature_weight_reference_triangle * aera_of_local_triangle/2
% quadrature_point_local_triangle = transform_matrix * vertices_local_triangle
% transform_matrix = [1 - quadrature_point_reference_triangle_x_1 - quadrature_point_reference_triangle_y_1, quadrature_point_reference_triangle_x_1, quadrature_point_reference_triangle_y_1, ...
%                     ......
%                     1 - quadrature_point_reference_triangle_x_(number_of_quadrature_points) - quadrature_point_reference_triangle_y_(number_of_quadrature_points), quadrature_point_reference_triangle_x_(number_of_quadrature_points), quadrature_point_reference_triangle_y_(number_of_quadrature_points)]
 
if number_of_quadrature_points == 3
    quadrature_weight_local_triangle = [1/6, 1/6, 1/6] * det([ones(1,3);vertices_triangle']); 
    quadrature_point_local_triangle = [1-1/2-0, 1/2, 0;...
                                       1-1/2-1/2, 1/2, 1/2;...
                                       1-0-1/2, 0, 1/2] * vertices_triangle;
elseif number_of_quadrature_points == 4
    quadrature_weight_local_triangle = [(1-1/sqrt(3))/8, (1-1/sqrt(3))/8, (1+1/sqrt(3))/8, (1+1/sqrt(3))/8] * det([ones(1,3);vertices_triangle']);
    quadrature_point_local_triangle = [1-(1/sqrt(3)+1)/2-(1-1/sqrt(3))*(1+1/sqrt(3))/4, (1/sqrt(3)+1)/2, (1-1/sqrt(3))*(1+1/sqrt(3))/4;...
                                       1-(1/sqrt(3)+1)/2-(1-1/sqrt(3))*(1-1/sqrt(3))/4, (1/sqrt(3)+1)/2, (1-1/sqrt(3))*(1-1/sqrt(3))/4;...
                                       1-(-1/sqrt(3)+1)/2-(1+1/sqrt(3))*(1+1/sqrt(3))/4, (-1/sqrt(3)+1)/2, (1+1/sqrt(3))*(1+1/sqrt(3))/4;...
                                       1-(-1/sqrt(3)+1)/2-(1+1/sqrt(3))*(1-1/sqrt(3))/4, (-1/sqrt(3)+1)/2, (1+1/sqrt(3))*(1-1/sqrt(3))/4] * vertices_triangle;
elseif number_of_quadrature_points == 7
    quadrature_weight_local_triangle = [0.22500000000000000, 0.12593918054482717, 0.12593918054482717, 0.12593918054482717, 0.13239415278850616, 0.13239415278850616, 0.13239415278850616]/2 * det([ones(1,3);vertices_triangle']);
    quadrature_point_local_triangle=[1-1/3-1/3, 1/3, 1/3;...
                                     1-0.79742698535308720-0.10128650732345633, 0.79742698535308720, 0.10128650732345633;...
                                     1-0.10128650732345633-0.79742698535308720, 0.10128650732345633, 0.79742698535308720;...
                                     1-0.10128650732345633-0.10128650732345633, 0.10128650732345633, 0.10128650732345633;...
                                     1-0.05971587178976981-0.47014206410511505, 0.05971587178976981, 0.47014206410511505;...
                                     1-0.47014206410511505-0.05971587178976981, 0.47014206410511505, 0.05971587178976981;...
                                     1-0.47014206410511505-0.47014206410511505, 0.47014206410511505, 0.47014206410511505] * vertices_triangle;
elseif number_of_quadrature_points == 9
    quadrature_weight_local_triangle = [64/81*(1-0)/8, 100/324*(1-sqrt(3/5))/8, 100/324*(1-sqrt(3/5))/8, 100/324*(1+sqrt(3/5))/8, 100/324*(1+sqrt(3/5))/8, 40/81*(1-0)/8, 40/81*(1-0)/8, 40/81*(1-sqrt(3/5))/8, 40/81*(1+sqrt(3/5))/8] * det([ones(1,3);vertices_triangle']);
    quadrature_point_local_triangle = [1-(1+0)/2-(1-0)*(1+0)/4, (1+0)/2, (1-0)*(1+0)/4;...
                                       1-(1+sqrt(3/5))/2-(1-sqrt(3/5))*(1+sqrt(3/5))/4, (1+sqrt(3/5))/2, (1-sqrt(3/5))*(1+sqrt(3/5))/4;...
                                       1-(1+sqrt(3/5))/2-(1-sqrt(3/5))*(1-sqrt(3/5))/4, (1+sqrt(3/5))/2, (1-sqrt(3/5))*(1-sqrt(3/5))/4;...
                                       1-(1-sqrt(3/5))/2-(1+sqrt(3/5))*(1+sqrt(3/5))/4, (1-sqrt(3/5))/2, (1+sqrt(3/5))*(1+sqrt(3/5))/4;...
                                       1-(1-sqrt(3/5))/2-(1+sqrt(3/5))*(1-sqrt(3/5))/4, (1-sqrt(3/5))/2, (1+sqrt(3/5))*(1-sqrt(3/5))/4;...
                                       1-(1+0)/2-(1-0)*(1+sqrt(3/5))/4, (1+0)/2, (1-0)*(1+sqrt(3/5))/4;...
                                       1-(1+0)/2-(1-0)*(1-sqrt(3/5))/4, (1+0)/2, (1-0)*(1-sqrt(3/5))/4;...
                                       1-(1+sqrt(3/5))/2-(1-sqrt(3/5))*(1+0)/4, (1+sqrt(3/5))/2, (1-sqrt(3/5))*(1+0)/4;...
                                       1-(1-sqrt(3/5))/2-(1+sqrt(3/5))*(1+0)/4, (1-sqrt(3/5))/2, (1+sqrt(3/5))*(1+0)/4] * vertices_triangle;
end

end